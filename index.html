<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digitální Logika: Interaktivní Hradla</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect x=%2210%22 y=%2210%22 width=%2280%22 height=%2280%22 rx=%2220%22 fill=%22%234f46e5%22/><path d=%22M35 50h30M65 50c0 15-10 25-30 25M65 50c0-15-10-25-30-25%22 stroke=%22white%22 stroke-width=%228%22 fill=%22none%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22/><circle cx=%2282%22 cy=%2250%22 r=%226%22 fill=%22white%22/></svg>">
    <style>
        :root {
            --bg-body: #f1f5f9;
            --bg-card: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --primary: #4f46e5;
            --green: #22c55e;
            --green-light: #dcfce7;
            --green-dark: #166534;
            --slate-50: #f8fafc;
            --yellow-50: #fefce8;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 40px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 20px;
        }

        h1 {
            font-size: 2rem;
            margin: 0 0 10px 0;
            color: #312e81;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .icon-box {
            background-color: var(--primary);
            color: white;
            padding: 8px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .code {
            font-family: monospace;
            background: #e2e8f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .code-green {
            background: var(--green-light);
            color: var(--green-dark);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            font-family: monospace;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .card {
            background: var(--bg-card);
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .card-header {
            background: var(--slate-50);
            padding: 16px;
            border-bottom: 1px solid var(--border);
        }

        .card-title {
            font-weight: 700;
            font-size: 1.125rem;
            margin: 0;
            color: var(--text-main);
        }

        .card-desc {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin: 4px 0 0 0;
        }

        .card-body {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            flex-grow: 1;
        }

        .vis-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .canvas-area {
            position: relative;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--border);
            width: 100%;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
        }

        .controls-left {
            position: absolute;
            left: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 12px;
            z-index: 10;
        }

        .btn-input {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 14px;
            border: 1px solid;
            cursor: pointer;
            transition: all 0.1s;
        }

        .btn-off {
            background: #f1f5f9;
            color: #475569;
            border-color: #cbd5e1;
        }

        .btn-off:hover { background: #e2e8f0; }

        .btn-on {
            background: var(--green);
            color: white;
            border-color: var(--green-dark);
            box-shadow: 0 2px 4px rgba(34, 197, 94, 0.3);
        }

        .indicator-right {
            position: absolute;
            right: 10px;
            z-index: 10;
        }

        .output-circle {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            border: 2px solid;
            transition: all 0.3s;
        }

        .out-off {
            background: #f1f5f9;
            color: #94a3b8;
            border-color: #e2e8f0;
        }

        .out-on {
            background: var(--green);
            color: white;
            border-color: var(--green-dark);
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.4);
            transform: scale(1.1);
        }

        svg {
            overflow: visible;
        }
        
        text {
            font-family: sans-serif;
            font-size: 5px; 
            fill: #94a3b8;
            font-weight: 600;
        }

        .formula-box {
            margin-top: 12px;
            background: #eff6ff;
            color: #1e3a8a;
            padding: 8px 20px;
            border-radius: 8px;
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.25rem;
            font-style: normal;
            border: 1px solid #bfdbfe;
            min-width: 120px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 40px;
        }

        .table-wrapper {
            width: 100%;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            font-size: 14px;
        }

        th {
            background: var(--slate-50);
            color: #475569;
            font-weight: 600;
            padding: 8px;
            border-bottom: 1px solid var(--border);
        }

        td {
            padding: 6px;
            border-right: 1px solid #f1f5f9;
            color: #64748b;
        }

        td:last-child { border-right: none; }

        tr.active-row {
            background-color: var(--yellow-50);
        }

        tr.active-row td {
            color: var(--text-main);
            font-weight: bold;
        }

        tr.active-row td.result-col {
            color: var(--green-dark);
            background-color: #f0fdf4;
        }

        .legend {
            margin-top: 40px;
            background: white;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .legend h4 {
            margin: 0 0 16px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-main);
        }

        .legend-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .legend-grid { grid-template-columns: 1fr; }
            h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        
        <header>
            <h1>
                <div class="icon-box">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
                </div>
                Digitální Logika
            </h1>
            <p class="subtitle">
                Interaktivní simulátor logických hradel. Nastavte vstupy 
                <span class="code">0</span> nebo <span class="code-green">1</span> a sledujte změny.
            </p>
        </header>

        <div id="gates-grid" class="grid"></div>

        <div class="legend">
            <h4>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                Vysvětlivky
            </h4>
            <div class="legend-grid">
                <div>
                    <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
                        <span class="btn-input btn-off" style="width:24px; height:24px; display:inline-flex; align-items:center; justify-content:center;">0</span>
                        <span><strong>Logická 0:</strong> Vypnuto (False)</span>
                    </div>
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span class="btn-input btn-on" style="width:24px; height:24px; display:inline-flex; align-items:center; justify-content:center;">1</span>
                        <span><strong>Logická 1:</strong> Zapnuto (True)</span>
                    </div>
                </div>
                <div>
                    <p style="margin:0 0 8px 0;"><strong>Pravdivostní tabulka:</strong> Ukazuje výstup pro všechny kombinace.</p>
                    <p style="margin:0;"><strong>Vzorec:</strong> Matematický zápis funkce.</p>
                </div>
            </div>
        </div>

    </div>

    <script>
        // === KONFIGURACE ===
        const gateCommon = 'fill="white" stroke="currentColor" stroke-width="1.5"'; 
        const wireActive = "#22c55e";
        const wireInactive = "#94a3b8"; 

        // SVG Cesty
        const PATHS = {
            XOR_BODY: `M73.52,20.74c-1.81,3.55-10.99,19.35-30.29,19.35h-15.91s-2.18,0-2.18,0c10.8-11.75,10.8-28.64,0-40.09h4.26s13.83,0,13.83,0C62.53,0,71.71,15.8,73.52,19.35l-.28.63`,
            XOR_SHIELD: `M21.34,1.7c10.29,11.63,10,25.33,0,36.69`,
            // Bubliny - středy upraveny pro dokonalé napojení
            BUBBLE_NOT: `M 72 20 m -4, 0 a 4,4 0 1,0 8,0 a 4,4 0 1,0 -8,0`, // Center 72
            BUBBLE_NAND: `M 74 20 m -4, 0 a 4,4 0 1,0 8,0 a 4,4 0 1,0 -8,0`, // Center 74
            BUBBLE_NOR: `M 77.5 20 m -4, 0 a 4,4 0 1,0 8,0 a 4,4 0 1,0 -8,0`, // Center 77.5
            
            AND_BODY: `M 28 2 H 52 A 18 18 0 0 1 52 38 H 28 Z`,
            BUFFER_BODY: `M 28 2 V 38 L 68 20 Z`
        };

        const GATES = [
            {
                id: 'buffer',
                name: 'Hradlo YES (Buffer)',
                desc: 'Výstup kopíruje vstup.',
                inputs: 1,
                logic: (a) => a,
                wireStart: 68, 
                inputEndX: 30, // Protaženo, aby šla čára pod trojúhelník
                symbolPath: `<path d="${PATHS.BUFFER_BODY}" ${gateCommon} />`
            },
            {
                id: 'not',
                name: 'Hradlo NOT',
                desc: 'Obrací hodnotu vstupu.',
                inputs: 1,
                logic: (a) => !a,
                wireStart: 75,
                inputEndX: 30, // Protaženo pod trojúhelník
                symbolPath: `<path d="${PATHS.BUFFER_BODY}" ${gateCommon} /><path d="${PATHS.BUBBLE_NOT}" ${gateCommon} />`
            },
            {
                id: 'and',
                name: 'Hradlo AND',
                desc: '1 když OBA vstupy jsou 1.',
                inputs: 2,
                logic: (a, b) => a && b,
                wireStart: 70, 
                inputEndX: 30, // Protaženo pod tělo (začíná na 28)
                symbolPath: `<path d="${PATHS.AND_BODY}" ${gateCommon} />`
            },
            {
                id: 'nand',
                name: 'Hradlo NAND',
                desc: '0 pouze když OBA vstupy jsou 1.',
                inputs: 2,
                logic: (a, b) => !(a && b),
                wireStart: 77, 
                inputEndX: 30, // Protaženo pod tělo (začíná na 28)
                symbolPath: `<path d="${PATHS.AND_BODY}" ${gateCommon} /><path d="${PATHS.BUBBLE_NAND}" ${gateCommon} />`
            },
            {
                id: 'or',
                name: 'Hradlo OR',
                desc: '1 když ALESPOŇ JEDEN vstup je 1.',
                inputs: 2,
                logic: (a, b) => a || b,
                wireStart: 73.5, 
                inputEndX: 32, // Protaženo hlouběji (tělo začíná cca 28-30)
                symbolPath: `<path d="${PATHS.XOR_BODY}" ${gateCommon} />`
            },
            {
                id: 'nor',
                name: 'Hradlo NOR',
                desc: '1 pouze když OBA vstupy jsou 0.',
                inputs: 2,
                logic: (a, b) => !(a || b),
                wireStart: 80.5,
                inputEndX: 32, // Protaženo hlouběji
                symbolPath: `<path d="${PATHS.XOR_BODY}" ${gateCommon} /><path d="${PATHS.BUBBLE_NOR}" ${gateCommon} />`
            },
            {
                id: 'xor',
                name: 'Hradlo XOR',
                desc: '1 pokud se vstupy LIŠÍ.',
                inputs: 2,
                logic: (a, b) => (a ? !b : b),
                wireStart: 73.5,
                inputEndX: 26, // Protaženo k bariéře
                symbolPath: `<path d="${PATHS.XOR_SHIELD}" fill="none" stroke="currentColor" stroke-width="2" /><path d="${PATHS.XOR_BODY}" ${gateCommon} />`
            },
            {
                id: 'xnor',
                name: 'Hradlo XNOR',
                desc: '1 pokud jsou vstupy SHODNÉ.',
                inputs: 2,
                logic: (a, b) => a === b,
                wireStart: 80.5,
                inputEndX: 26, // Protaženo k bariéře
                symbolPath: `<path d="${PATHS.XOR_SHIELD}" fill="none" stroke="currentColor" stroke-width="2" /><path d="${PATHS.XOR_BODY}" ${gateCommon} /><path d="${PATHS.BUBBLE_NOR}" ${gateCommon} />`
            }
        ];

        const appState = {};
        GATES.forEach(g => appState[g.id] = { a: 0, b: 0 });

        function renderApp() {
            const grid = document.getElementById('gates-grid');
            grid.innerHTML = '';
            GATES.forEach(gate => {
                grid.appendChild(createGateCard(gate));
            });
        }

        function createGateCard(gate) {
            const state = appState[gate.id];
            const outputBool = gate.inputs === 1 ? gate.logic(state.a) : gate.logic(state.a, state.b);
            const output = outputBool ? 1 : 0;
            
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div class="card-header">
                    <h3 class="card-title">${gate.name}</h3>
                    <p class="card-desc">${gate.desc}</p>
                </div>
                <div class="card-body">
                    <div class="vis-container">
                        <div class="canvas-area">
                            <div class="controls-left">
                                <button class="btn-input ${state.a ? 'btn-on' : 'btn-off'}" onclick="toggleInput('${gate.id}', 'a')">${state.a}</button>
                                ${gate.inputs === 2 ? `<button class="btn-input ${state.b ? 'btn-on' : 'btn-off'}" onclick="toggleInput('${gate.id}', 'b')">${state.b}</button>` : ''}
                            </div>
                            <div class="indicator-right">
                                <div class="output-circle ${output ? 'out-on' : 'out-off'}">${output}</div>
                            </div>
                            ${renderSVG(gate, state, output)}
                        </div>
                        <div class="formula-box">
                            ${getFormula(gate, state, output)}
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>A</th>
                                    ${gate.inputs === 2 ? '<th>B</th>' : ''}
                                    <th>Z</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${generateTableRows(gate, state)}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            return card;
        }

        function renderSVG(gate, state, output) {
            const viewBox = "0 -5 125 50"; 
            
            const wColA = state.a ? wireActive : wireInactive;
            const wColB = state.b ? wireActive : wireInactive;
            const wColOut = output ? wireActive : wireInactive;
            
            const ieX = gate.inputEndX;
            const wireStartX = 0; 

            let wiresHTML = '';
            
            const labelA = `<text x="5" y="8" fill="#94a3b8">A</text>`;
            const labelB = `<text x="5" y="28" fill="#94a3b8">B</text>`;
            const labelZ = `<text x="105" y="15" fill="#94a3b8">Z</text>`;

            if (gate.inputs === 1) {
                wiresHTML = `
                    <path d="M ${wireStartX},20 H ${ieX}" fill="none" stroke="${wColA}" stroke-width="1.5" />
                    <text x="5" y="18" fill="#94a3b8">A</text>
                `;
            } else {
                wiresHTML = `
                    <path d="M ${wireStartX},10 H ${ieX}" fill="none" stroke="${wColA}" stroke-width="1.5" />
                    <path d="M ${wireStartX},30 H ${ieX}" fill="none" stroke="${wColB}" stroke-width="1.5" />
                    ${labelA}
                    ${labelB}
                `;
            }

            const outputWire = `<path d="M 125,20 H ${gate.wireStart}" fill="none" stroke="${wColOut}" stroke-width="1.5" />`;

            return `
                <svg width="100%" height="100%" viewBox="${viewBox}" preserveAspectRatio="xMidYMid meet">
                    ${wiresHTML}
                    ${outputWire}
                    <g class="gate-symbol">${gate.symbolPath}</g>
                    ${labelZ}
                </svg>
            `;
        }

        function getFormula(gate, state, output) {
            const A = state.a;
            const B = state.b;
            const Z = output; 
            const overline = 'style="text-decoration: overline; text-decoration-thickness: 1.5px;"';

            switch(gate.id) {
                case 'buffer': return `${Z} = ${A}`;
                case 'not':    return `${Z} = <span ${overline}>${A}</span>`;
                case 'and':    return `${Z} = ${A} · ${B}`;
                case 'nand':   return `${Z} = <span ${overline}>${A} · ${B}</span>`;
                case 'or':     return `${Z} = ${A} + ${B}`;
                case 'nor':    return `${Z} = <span ${overline}>${A} + ${B}</span>`;
                case 'xor':    return `${Z} = ${A} ⊕ ${B}`;
                case 'xnor':   return `${Z} = <span ${overline}>${A} ⊕ ${B}</span>`;
                default:       return '';
            }
        }

        function generateTableRows(gate, state) {
            const rows = [];
            if (gate.inputs === 1) rows.push([0], [1]);
            else rows.push([0, 0], [0, 1], [1, 0], [1, 1]);

            return rows.map(inputs => {
                const resBool = gate.inputs === 1 ? gate.logic(inputs[0]) : gate.logic(inputs[0], inputs[1]);
                const res = resBool ? 1 : 0;
                let isActive = false;
                if (gate.inputs === 1) isActive = (inputs[0] === state.a);
                else isActive = (inputs[0] === state.a && inputs[1] === state.b);
                const activeClass = isActive ? 'class="active-row"' : '';
                
                let html = `<tr ${activeClass}>`;
                html += `<td>${inputs[0]}</td>`;
                if (gate.inputs === 2) html += `<td>${inputs[1]}</td>`;
                html += `<td class="result-col">${res}</td></tr>`;
                return html;
            }).join('');
        }

        window.toggleInput = function(gateId, input) {
            const current = appState[gateId][input];
            appState[gateId][input] = current === 0 ? 1 : 0;
            renderApp();
        };

        renderApp();
    </script>
</body>
</html>
